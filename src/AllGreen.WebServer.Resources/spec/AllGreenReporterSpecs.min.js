var _this=this;describe("AllGreen.this.runnerReporter",function(){beforeEach(function(){jasmine.getEnv().currentSpec.addMatchers({toBeSpecElement:function(n,t){var r=this.actual,i,u;return expect(r).toHaveLength(1),expect(r).toBe("div"),expect(r).toHaveClass("spec"),expect(r).toHaveClass(t),i=r.children(".spec-name"),expect(i).toHaveLength(1),expect(i).toBe("a"),expect(i).toHaveText(n),expect(i).toHaveAttr("href","#"),u=spyOnEvent(i,"click"),i.click(),expect(u).toHaveBeenTriggered(),!0},toBeSuiteElement:function(n,t){var r=this.actual,i,f,u;return expect(r).toHaveLength(1),expect(r).toBe("div"),expect(r).toHaveClass("suite"),expect(r).toHaveClass(t),i=r.children(".suite-name"),expect(i).toHaveLength(1),expect(i).toBe("a"),expect(i).toHaveText(n),expect(i).toHaveAttr("href","#"),f=spyOnEvent(i,"click"),i.click(),expect(f).toHaveBeenTriggered(),u=r.children(".suite-content"),expect(u).toHaveLength(1),expect(u).toBe("div"),!0}}),jasmine.getFixtures().fixturesPath="";var n=readFixtures("Client/client.html");n=n.replace(/<script[^>]*><\/script>/g,""),n=n.replace(/<script[^>]*>[^<]*AllGreen\.startApp()[^<]*<\/script>/g,""),setFixtures(n),_this.serverReporter=new AllGreen.ServerReporter,_this.runnerReporter=new AllGreen.RunnerReporter,_this.suite1={id:444,name:"suite 1",parentSuite:null}}),afterEach(function(){_this.serverReporter=null,_this.runnerReporter=null}),it("Is Default",function(){expect($("#server-status")).toHaveHtml("Connecting..."),expect($("#runner-status")).toHaveHtml("Waiting..."),expect($("#spec-results")).toBeEmpty()}),it("Can be reset",function(){_this.runnerReporter.started(),_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Passed}),_this.runnerReporter.reset(),expect($("#runner-status")).toHaveHtml("Waiting..."),expect($("#spec-results")).toBeEmpty()}),it("Updates server status",function(){_this.serverReporter.setServerStatus("NEW SERVER STATUS"),expect($("#server-status")).toHaveHtml("NEW SERVER STATUS")}),it("Updates runner status",function(){_this.runnerReporter.started(),expect($("#runner-status")).toHaveHtml("Running...")}),it("Displays spec status",function(){_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Passed}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Passed),expect($("#spec-results > #suite-444 > .suite-content > #spec-123")).toBeSpecElement("test 1","passed"),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","passed"),expect($("#spec-results")).toHaveClass("passed")}),it("Displays failed spec steps",function(){var n=[{message:"log message"},{message:"expected something and succeded",status:AllGreen.SpecStatus.Passed},{message:"expected something and failed",status:AllGreen.SpecStatus.Failed,trace:"trace 1\ntrace 2"}];_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Failed,steps:n}),expect($("#spec-results > #suite-444 > .suite-content > #spec-123")).toBeSpecElement("test 1","failed"),expect($("#spec-results > #suite-444 > .suite-content > #spec-123 > .spec-steps > .spec-step")).toHaveLength(3),expect($("#spec-results > #suite-444 > .suite-content > #spec-123 > .spec-steps > .spec-step.log")).toHaveLength(1),expect($("#spec-results > #suite-444 > .suite-content > #spec-123 > .spec-steps > .spec-step.passed")).toHaveLength(1),expect($("#spec-results > #suite-444 > .suite-content > #spec-123 > .spec-steps > .spec-step.failed")).toHaveLength(1),expect($("#spec-results > #suite-444 > .suite-content > #spec-123 > .spec-steps > .spec-step.failed > .spec-step-trace")).toHaveHtml("trace 1<br/>trace 2")}),it("Updates spec status",function(){_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Passed}),_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Failed}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Failed),expect($("#spec-results > #suite-444 > .suite-content > #spec-123")).toBeSpecElement("test 1","failed"),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","failed"),expect($("#spec-results")).toHaveClass("failed")}),it("Updates suite status",function(){_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Passed}),_this.runnerReporter.specUpdated({id:323,name:"test 2",suite:_this.suite1,status:AllGreen.SpecStatus.Failed}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Failed),expect($("#spec-results > #suite-444 > .suite-content > #spec-123")).toBeSpecElement("test 1","passed"),expect($("#spec-results > #suite-444 > .suite-content > #spec-323")).toBeSpecElement("test 2","failed"),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","failed"),expect($("#spec-results")).toHaveClass("failed")}),it("Supports nested suites",function(){var n={id:744,name:"suite 2",parentSuite:_this.suite1,status:AllGreen.SpecStatus.Undefined};_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:n,status:AllGreen.SpecStatus.Passed}),_this.runnerReporter.specUpdated({id:323,name:"test 2",suite:n,status:AllGreen.SpecStatus.Failed}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Failed),expect(n.status).toBe(AllGreen.SpecStatus.Failed),expect($("#spec-results > #suite-444 > .suite-content > #suite-744 > .suite-content > #spec-123")).toBeSpecElement("test 1","passed"),expect($("#spec-results > #suite-444 > .suite-content > #suite-744 > .suite-content > #spec-323")).toBeSpecElement("test 2","failed"),expect($("#spec-results > #suite-444 > .suite-content > #suite-744")).toBeSuiteElement("suite 2","failed"),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","failed"),expect($("#spec-results")).toHaveClass("failed")}),it("Shows final suite status",function(){_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Running}),_this.runnerReporter.specUpdated({id:223,name:"test 2",suite:_this.suite1,status:AllGreen.SpecStatus.Running}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Running),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","running"),expect($("#spec-results")).toHaveClass("running"),_this.runnerReporter.specUpdated({id:123,name:"test 1",suite:_this.suite1,status:AllGreen.SpecStatus.Passed}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Running),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","running"),expect($("#spec-results")).toHaveClass("running"),_this.runnerReporter.specUpdated({id:223,name:"test 2",suite:_this.suite1,status:AllGreen.SpecStatus.Failed}),expect(_this.suite1.status).toBe(AllGreen.SpecStatus.Failed),expect($("#spec-results > #suite-444")).toBeSuiteElement("suite 1","failed"),expect($("#spec-results")).toHaveClass("failed")})})