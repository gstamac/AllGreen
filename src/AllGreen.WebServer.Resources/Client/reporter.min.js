var AllGreen;(function(n){var i=function(){function n(){this.DEFAULT_SERVER_STATUS="Connecting..."}return n.prototype.setServerStatus=function(n){this.getServerStatusElement().html(n)},n.prototype.getServerStatusElement=function(){return $("#server-status")},n}(),t;n.ServerReporter=i,t=function(){function t(){this.DEFAULT_RUNNER_STATUS="Waiting...",this.totalStatus=null}return t.prototype.isReady=function(){return!0},t.prototype.reset=function(){this.setRunnerStatus(this.DEFAULT_RUNNER_STATUS),this.getSpecResultsElement().text(""),this.totalStatus=null},t.prototype.started=function(n){this.setRunnerStatus("Running "+n+" tests...")},t.prototype.specUpdated=function(n){var t=this.getSpecElement(n);this.setSpecElementClass(t,n.status),this.setSpecElementSteps(t,n.steps),this.updateSuiteStatus(n.suite,n.status)},t.prototype.finished=function(){this.setRunnerStatus("Finished")},t.prototype.setRunnerStatus=function(n){this.getRunnerStatusElement().html(n)},t.prototype.getRunnerStatusElement=function(){return $("#runner-status")},t.prototype.getSpecResultsElement=function(){return $("#spec-results")},t.prototype.getSpecElement=function(n){var t=$("#spec-"+n.id);return t.length<=0&&(t=this.createSpecElement(n)),t},t.prototype.createSpecElement=function(n){var i=this.getSuiteContentElement(n.suite),t=$("<div/>").addClass("spec").prop("id","spec-"+n.id);return $("<a/>").prop("href","#").html(n.name).addClass("spec-name").click(function(){$("#spec-"+n.id+" > .spec-steps").toggle()}).appendTo(t),t.appendTo(i),t},t.prototype.setSpecElementClass=function(n,t){n.prop("class","spec "+this.statusClass(t))},t.prototype.setSpecElementSteps=function(n,t){var i=n.children(".spec-steps"),f,r,u;if(t&&t.length)for(i.length||(i=$("<div/>").addClass("spec-steps"),i.appendTo(n)),i.html(""),f=0;f<t.length;f++)r=t[f],u=$("<div/>").html(r.message).addClass("spec-step"),r.status?u.addClass(this.statusClass(r.status)):u.addClass("log"),r.trace&&$("<div/>").html(r.trace.replace(/\n/g,"<br/>")).addClass("spec-step-trace").appendTo(u),u.appendTo(i);else i.length&&i.remove()},t.prototype.updateSuiteStatus=function(n,t){var i;n?(i=$("#suite-"+n.id),i&&(n.status=this.investigateSuiteStatus(i.children(".suite-content")),this.setSuiteElementClass(i,n.status)),this.updateSuiteStatus(n.parentSuite,t)):(i=this.getSpecResultsElement(),i&&(this.totalStatus=this.investigateSuiteStatus(i),this.setSuiteElementClass(i,this.totalStatus)))},t.prototype.investigateSuiteStatus=function(t){return t.children(".running").length?n.SpecStatus.Running:t.children(".failed").length?n.SpecStatus.Failed:t.children(".undefined").length?n.SpecStatus.Undefined:t.children(".passed").length?n.SpecStatus.Passed:n.SpecStatus.Skipped},t.prototype.setSuiteElementClass=function(n,t){n.prop("class","suite "+this.statusClass(t))},t.prototype.getSuiteContentElement=function(n){if(n){var t=$("#suite-"+n.id+" > .suite-content");return t.length<=0&&(t=this.createSuiteElement(n).children(".suite-content")),t}return this.getSpecResultsElement()},t.prototype.createSuiteElement=function(n){var i=this.getSuiteContentElement(n.parentSuite),t=$("<div/>").addClass("suite").prop("id","suite-"+n.id);return $("<a/>").prop("href","#").html(n.name).addClass("suite-name").click(function(){$("#suite-"+n.id+" > .suite-content").toggle()}).appendTo(t),$("<div/>").addClass("suite-content").appendTo(t),t.appendTo(i),t},t.prototype.statusClass=function(t){var i=n.SpecStatus[t];return i.toLowerCase()},t}(),n.RunnerReporter=t})(AllGreen||(AllGreen={})),function(){var n=AllGreen.App.getCurrent();n!=null&&(n.log("registering reporter factory"),n.setServerReporter(new AllGreen.ServerReporter),n.registerRunnerReporter(new AllGreen.RunnerReporter))}()