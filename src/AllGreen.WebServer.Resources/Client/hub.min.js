var AllGreen;(function(n){function r(t){var i,r,u;t.log("registering signalR hub"),i=new n.HubReporter,t.registerRunnerReporter(i),r=$.hubConnection(),r.logging=!0,u=new n.Hub(r,t,i),u.connect()}var i=function(){function n(n,t,i,r){typeof r=="undefined"&&(r=5e3),this.connection=n,this.app=t,this.reporter=i,this.reconnectTimeout=r,t.setServerStatus("Disconnected")}return n.prototype.connect=function(){this.hubProxy=this.attachToHub(this.connection,this.app),this.attachToConnectionEvents(this.connection,this.app),this.startConnection(this.connection,this.app)},n.prototype.attachToHub=function(n,t){var i=n.createHubProxy("runnerHub");i.on("reload",function(){t.log("reloading..."),t.reload()});return i},n.prototype.attachToConnectionEvents=function(n,t){var i=this;n.stateChanged(function(n){t.log("state changed ",n,i.stateString(n.oldState)," -> ",i.stateString(n.newState))}),n.error(function(n){t.log("error",n),t.setServerStatus("Error: "+n)}),n.reconnecting(function(){t.log("reconnecting"),t.setServerStatus("Reconnecting...")}),n.reconnected(function(){t.log("reconnected"),t.setServerStatus("Reconnected"),i.register()}),n.disconnected(function(){t.log("disconnected"),t.setServerStatus("Disconnected"),t.log("reconnecting in 5s"),setTimeout(function(){t.reconnectEnabled&&i.startConnection(n,t)},i.reconnectTimeout)})},n.prototype.startConnection=function(n,t){var i=this;n.start().done(function(){t.log("connected as "+n.id),t.setServerStatus("Connected"),i.register()})},n.prototype.register=function(){this.reporter.hubProxyConnected(this.hubProxy),this.hubProxy.invoke("register")},n.prototype.stateString=function(n){return n===$.signalR.connectionState.connecting?"connecting":n===$.signalR.connectionState.connected?"connected":n===$.signalR.connectionState.reconnecting?"reconnecting":n===$.signalR.connectionState.disconnected?"disconnected":void 0},n}(),t;n.Hub=i,t=function(){function n(){this.hubProxy=null}return n.prototype.isReady=function(){return this.hubProxy!=null},n.prototype.hubProxyConnected=function(n){this.hubProxy=n},n.prototype.reset=function(){this.hubProxy.invoke("reset")},n.prototype.started=function(n){this.hubProxy.invoke("started",n)},n.prototype.specUpdated=function(n){this.hubProxy.invoke("specUpdated",n)},n.prototype.finished=function(){this.hubProxy.invoke("finished")},n}(),n.HubReporter=t,n.initializeHub=r})(AllGreen||(AllGreen={}))